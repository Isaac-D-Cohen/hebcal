<html><head>
<META HTTP-EQUIV="content-type" CONTENT="text/html;charset=utf-8">
<SCRIPT TYPE="text/javascript" SRC="assert.js"></script>
<SCRIPT TYPE="text/javascript" SRC="hebcal.js"></script>
<SCRIPT TYPE="text/javascript" SRC="b-mitzvah.js"></script>
<SCRIPT TYPE="text/javascript" SRC="sedra.js"></script>
<SCRIPT TYPE="text/javascript" SRC="greg.js"></script>

<script type="text/javascript">
function doCalc(){

//unary + is the string->number conversion until Javascript 2.0
    var gMonth=  +document.getElementById("bMonth").value;
    var gDay =  + document.getElementById("bDay").value;
    var gYear =  + document.getElementById("bYear").value;
    var isMale = document.getElementById("sex-male").checked;
    var afterSundown = document.getElementById("after-sundown").checked;
    var israeliSedra = document.getElementById("israeli-sedra").checked;
    if(null == gMonth || null == gDay || null == gYear ){
        alert("null values!"+gMonth + "|"+gDay+"|" +gYear);
       return false;
    }

    var elem = document.getElementById("buffer");
    while(elem.firstChild){
        elem.removeChild(elem.firstChild);
    }
    elem.appendChild(document.createTextNode("input = "+gYear + "-"+gMonth+"-" +gDay));

// this is the meat 
    var gregBday = new HebcalGregorianDate(gYear, gMonth, gDay);
    var absBday = greg2abs( gregBday) + afterSundown ;
    var hebBirthdate = abs2hebrew(absBday);
    var barMitzvahHebDate = bMitzvah(hebBirthdate,isMale);
    showDate(hebBirthdate,"rtl");
    showDate(barMitzvahHebDate,"rtl");

    var sedraCalc = new Sedra( barMitzvahHebDate.hYear, israeliSedra);
    show("sedra medatada: "+sedraCalc.toString());
    var parsha = sedraCalc.getSedraFromHebcalDate( barMitzvahHebDate);
    show( "parsha is "+parsha);

    
//NEXT: show the gregorian date for the Mitzvah
<!--     var barMitzvahHebcalHebDate = HebcalHebrewDate.fromKALDate( barMitzvahKLHebDate ); -->
    var absBM = hebrew2abs(barMitzvahHebDate);
    var gregBM = abs2greg(absBM);
    show( "gregoria bar-mitzvah = "+gregBM.toString());


    

}

function show(str){
    var elem = document.getElementById("buffer");
    var div = document.createElement("div")
        elem.appendChild(div);
    div.setAttribute("dir","ltr");
    div.appendChild(document.createTextNode(str));
}

function showDate(theDate, dir){
    var elem = document.getElementById("buffer");
    var div = document.createElement("span");
    elem.appendChild(document.createElement("br"));
    elem.appendChild(div);
    elem.appendChild(document.createElement("br"));
    div.setAttribute("dir",dir);
    div.appendChild(document.createTextNode(theDate.toString()));
}
</script>
</head>

<body>
<h2>Enter your Gregorian Birthday</h2>
<form id="input">
 Day [1-31]:      <input name="bDay" id="bDay">
<br>Month [1-12]: <input id="bMonth" name="bMonth">
<br>Year [e.g. 1992]:  <input id="bYear" name="bYear">
<br>After sundown?  <input type="checkbox" name="after-sundown" id="after-sundown">
<br>Israeli Sedra Scheme?  <input type="checkbox" name="after-sundown" id="israeli-sedra">
<div>
<b>מין:</b>
<table style="border:none">
<tr><th>זכר</th><td><input checked="1" id="sex-male" type="radio"  name="sex" value="male">
<tr><th>נקבה</th><td><input type="radio"  id="sex-female" name="sex" value="female">
</table>
</div>
<br><a href="#" onclick="return doCalc()">Calculate</a>
 </form>

<div style="border-style:solid" border="ltr" id="buffer"></div>
</body>
</html>
